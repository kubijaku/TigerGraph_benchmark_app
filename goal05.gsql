USE GRAPH ADS

DROP query getNeighbors

BEGIN
CREATE QUERY getNeighbors(STRING nodeId) FOR GRAPH ADS {

    # Step 1: Declare a global vertex set accumulator
    SetAccum<VERTEX> @@allNeighbors;

    # Step 2: Traverse outgoing edges (successors) and add to accumulator
    tmp = SELECT neighbor
    FROM Entity:current -(Relation:e)-> Entity:neighbor
    WHERE current.id == nodeId
    ACCUM @@allNeighbors += neighbor;

    # Step 3: Traverse incoming edges (predecessors) and add to accumulator
    tmp = SELECT neighbor
    FROM Entity:neighbor -(Relation:e)-> Entity:current
    WHERE current.id == nodeId
    ACCUM @@allNeighbors += neighbor;

    # Step 4: Print the combined set of all neighbors
    PRINT @@allNeighbors AS allNeighbors;
}
END

INSTALL QUERY getNeighbors

RUN QUERY getNeighbors("/c/en/linguistics")